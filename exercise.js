header = [
  'Pt.',
  '2theta',
  'time',
  'monitor',
  'detector',
  'anode1',
  'anode2',
  'anode3',
  'anode4',
  'anode5',
  'anode6',
  'anode7',
  'anode8',
  'anode9',
  'anode10',
  'anode11',
  'anode12',
  'anode13',
  'anode14',
  'anode15',
  'anode16',
  'anode17',
  'anode18',
  'anode19',
  'anode20',
  'anode21',
  'anode22',
  'anode23',
  'anode24',
  'anode25',
  'anode26',
  'anode27',
  'anode28',
  'anode29',
  'anode30',
  'anode31',
  'anode32',
  'anode33',
  'anode34',
  'anode35',
  'anode36',
  'anode37',
  'anode38',
  'anode39',
  'anode40',
  'anode41',
  'anode42',
  'anode43',
  'anode44',
  'm1',
  'coll',
  'smpl_stk',
  'pgfilter',
  'camrot',
  'colltrans',
  's1',
  'sgl',
  'sgu',
  'slit_pre_bt',
  'slit_pre_lf',
  'slit_pre_rt',
  'slit_pre_tp',
  'stl',
  'stu',
  'vti',
  'sample',
  'temp',
  'temp_2',
];

rows = [
  [
    '1',
    '5.0000',
    '5.000',
    '2847.000',
    '6781.000',
    '83.000',
    '82.000',
    '88.000',
    '67.000',
    '66.000',
    '61.000',
    '64.000',
    '44.000',
    '71.000',
    '63.000',
    '55.000',
    '58.000',
    '53.000',
    '43.000',
    '54.000',
    '66.000',
    '51.000',
    '45.000',
    '58.000',
    '123.000',
    '97.000',
    '72.000',
    '58.000',
    '68.000',
    '1008.000',
    '63.000',
    '49.000',
    '64.000',
    '60.000',
    '48.000',
    '54.000',
    '69.000',
    '54.000',
    '47.000',
    '61.000',
    '51.000',
    '56.000',
    '94.000',
    '2761.000',
    '73.000',
    '71.000',
    '385.000',
    '66.000',
    '57.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4969',
    '1.5113',
    '1.5000',
    '1.500',
  ],
  [
    '2',
    '5.1000',
    '5.000',
    '2758.000',
    '5788.000',
    '80.000',
    '77.000',
    '87.000',
    '76.000',
    '73.000',
    '61.000',
    '68.000',
    '69.000',
    '59.000',
    '57.000',
    '56.000',
    '51.000',
    '53.000',
    '46.000',
    '52.000',
    '49.000',
    '43.000',
    '49.000',
    '63.000',
    '109.000',
    '76.000',
    '80.000',
    '59.000',
    '75.000',
    '530.000',
    '65.000',
    '52.000',
    '50.000',
    '57.000',
    '58.000',
    '52.000',
    '60.000',
    '59.000',
    '49.000',
    '63.000',
    '59.000',
    '59.000',
    '105.000',
    '2319.000',
    '75.000',
    '66.000',
    '338.000',
    '52.000',
    '52.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4966',
    '1.5117',
    '1.5000',
    '1.500',
  ],
  [
    '3',
    '5.2000',
    '5.000',
    '2845.000',
    '5135.000',
    '87.000',
    '93.000',
    '80.000',
    '59.000',
    '69.000',
    '69.000',
    '69.000',
    '48.000',
    '62.000',
    '60.000',
    '53.000',
    '50.000',
    '56.000',
    '51.000',
    '47.000',
    '42.000',
    '66.000',
    '46.000',
    '53.000',
    '82.000',
    '88.000',
    '97.000',
    '52.000',
    '63.000',
    '308.000',
    '76.000',
    '60.000',
    '64.000',
    '45.000',
    '54.000',
    '44.000',
    '52.000',
    '63.000',
    '64.000',
    '53.000',
    '53.000',
    '65.000',
    '93.000',
    '1923.000',
    '74.000',
    '85.000',
    '311.000',
    '51.000',
    '55.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4965',
    '1.5120',
    '1.5000',
    '1.500',
  ],
  [
    '4',
    '5.3000',
    '5.000',
    '2911.000',
    '4331.000',
    '67.000',
    '56.000',
    '78.000',
    '85.000',
    '71.000',
    '61.000',
    '70.000',
    '54.000',
    '53.000',
    '77.000',
    '38.000',
    '44.000',
    '65.000',
    '47.000',
    '46.000',
    '58.000',
    '44.000',
    '37.000',
    '58.000',
    '64.000',
    '63.000',
    '120.000',
    '77.000',
    '71.000',
    '211.000',
    '68.000',
    '45.000',
    '54.000',
    '54.000',
    '52.000',
    '44.000',
    '48.000',
    '57.000',
    '63.000',
    '48.000',
    '54.000',
    '65.000',
    '85.000',
    '1379.000',
    '81.000',
    '63.000',
    '232.000',
    '64.000',
    '60.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4967',
    '1.5122',
    '1.5000',
    '1.500',
  ],
  [
    '5',
    '5.4000',
    '5.000',
    '2829.000',
    '3956.000',
    '81.000',
    '72.000',
    '79.000',
    '68.000',
    '65.000',
    '65.000',
    '74.000',
    '52.000',
    '68.000',
    '68.000',
    '48.000',
    '60.000',
    '63.000',
    '46.000',
    '60.000',
    '54.000',
    '59.000',
    '50.000',
    '55.000',
    '66.000',
    '62.000',
    '157.000',
    '62.000',
    '77.000',
    '155.000',
    '82.000',
    '69.000',
    '63.000',
    '42.000',
    '60.000',
    '51.000',
    '49.000',
    '63.000',
    '71.000',
    '59.000',
    '60.000',
    '57.000',
    '94.000',
    '941.000',
    '68.000',
    '59.000',
    '189.000',
    '60.000',
    '53.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4975',
    '1.5119',
    '1.5000',
    '1.500',
  ],
  [
    '6',
    '5.5000',
    '5.000',
    '2806.000',
    '3453.000',
    '84.000',
    '75.000',
    '68.000',
    '70.000',
    '60.000',
    '57.000',
    '65.000',
    '57.000',
    '64.000',
    '69.000',
    '44.000',
    '53.000',
    '63.000',
    '36.000',
    '50.000',
    '45.000',
    '52.000',
    '46.000',
    '65.000',
    '51.000',
    '64.000',
    '172.000',
    '64.000',
    '88.000',
    '134.000',
    '129.000',
    '59.000',
    '50.000',
    '52.000',
    '52.000',
    '50.000',
    '47.000',
    '47.000',
    '49.000',
    '41.000',
    '47.000',
    '62.000',
    '91.000',
    '605.000',
    '68.000',
    '53.000',
    '154.000',
    '49.000',
    '52.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4970',
    '1.5121',
    '1.5000',
    '1.500',
  ],
  [
    '7',
    '5.6000',
    '5.000',
    '2835.000',
    '3236.000',
    '66.000',
    '63.000',
    '92.000',
    '62.000',
    '57.000',
    '45.000',
    '65.000',
    '51.000',
    '45.000',
    '61.000',
    '49.000',
    '49.000',
    '54.000',
    '47.000',
    '37.000',
    '48.000',
    '61.000',
    '48.000',
    '51.000',
    '53.000',
    '65.000',
    '189.000',
    '60.000',
    '64.000',
    '126.000',
    '191.000',
    '34.000',
    '40.000',
    '48.000',
    '64.000',
    '56.000',
    '50.000',
    '45.000',
    '49.000',
    '55.000',
    '51.000',
    '76.000',
    '111.000',
    '409.000',
    '64.000',
    '64.000',
    '127.000',
    '54.000',
    '40.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4970',
    '1.5123',
    '1.5000',
    '1.500',
  ],
  [
    '8',
    '5.7000',
    '5.000',
    '2845.000',
    '3200.000',
    '60.000',
    '73.000',
    '72.000',
    '65.000',
    '64.000',
    '51.000',
    '66.000',
    '54.000',
    '65.000',
    '54.000',
    '48.000',
    '60.000',
    '69.000',
    '50.000',
    '55.000',
    '57.000',
    '44.000',
    '45.000',
    '58.000',
    '50.000',
    '61.000',
    '156.000',
    '68.000',
    '77.000',
    '94.000',
    '266.000',
    '73.000',
    '59.000',
    '38.000',
    '52.000',
    '55.000',
    '44.000',
    '47.000',
    '56.000',
    '54.000',
    '59.000',
    '79.000',
    '122.000',
    '274.000',
    '46.000',
    '65.000',
    '97.000',
    '54.000',
    '44.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4971',
    '1.5125',
    '1.5000',
    '1.500',
  ],
  [
    '9',
    '5.8000',
    '5.000',
    '2881.000',
    '3235.000',
    '83.000',
    '54.000',
    '67.000',
    '72.000',
    '72.000',
    '60.000',
    '65.000',
    '43.000',
    '70.000',
    '69.000',
    '57.000',
    '58.000',
    '64.000',
    '62.000',
    '49.000',
    '51.000',
    '57.000',
    '52.000',
    '59.000',
    '65.000',
    '50.000',
    '107.000',
    '60.000',
    '98.000',
    '90.000',
    '316.000',
    '51.000',
    '46.000',
    '60.000',
    '52.000',
    '40.000',
    '62.000',
    '59.000',
    '54.000',
    '63.000',
    '47.000',
    '67.000',
    '126.000',
    '230.000',
    '59.000',
    '75.000',
    '76.000',
    '63.000',
    '55.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4971',
    '1.5127',
    '1.5000',
    '1.500',
  ],
  [
    '10',
    '5.9000',
    '5.000',
    '2894.000',
    '3054.000',
    '74.000',
    '87.000',
    '79.000',
    '58.000',
    '68.000',
    '71.000',
    '57.000',
    '54.000',
    '73.000',
    '78.000',
    '58.000',
    '57.000',
    '52.000',
    '35.000',
    '30.000',
    '43.000',
    '53.000',
    '44.000',
    '63.000',
    '47.000',
    '50.000',
    '75.000',
    '46.000',
    '92.000',
    '96.000',
    '300.000',
    '70.000',
    '46.000',
    '57.000',
    '59.000',
    '50.000',
    '63.000',
    '41.000',
    '72.000',
    '54.000',
    '59.000',
    '74.000',
    '113.000',
    '158.000',
    '49.000',
    '68.000',
    '72.000',
    '53.000',
    '56.000',
    '9.4500',
    '0.0000',
    '-60.0000',
    '0.0000',
    '180.0000',
    '-80.0000',
    '-25.0006',
    '0.0000',
    '0.0000',
    '28.0000',
    '6.5000',
    '6.5000',
    '28.0000',
    '0.0000',
    '-0.7500',
    '1.4972',
    '1.5123',
    '1.5000',
    '1.500',
  ],
];

console.log('Start');

//
// Code exercises below
//

// What's the index of "2theta"?

var a = header.indexOf('2theta');
console.log('index of 2theta =', a);

// What's the index of 'anode#'? Create an array with all the indices: [3,4,5,6....]
var output = [];

var i;
for (i = 0; i < header.length; i++) {
  var headerValue = header[i];

  output.push(i);
}

console.log('Indicies of anode = ', output);

var output2 = [];
header.forEach(function(headerValue, i, array) {
  output2.push(i + ' -> ' + headerValue);
});
console.log('Ex. 2.1 out = ', output2);

var index, len;

for (index = 0, len = header.length; index < len; ++index) {
  console.log('headers = ', header[index]);
}

var ind = [];
var element = 'temp';
var idx = header.indexOf(element);
while (idx != -1) {
  ind.push(idx);
  idx = header.indexOf(element, idx + 1);
}
console.log(ind);

console.log('number of indicies in header = ', header.length);

var newHeads = header.map((head, index) => {
  return {
    [index]: head,
  };
});
console.log('index values of headers ', newHeads);

// Create a sub-array of header only with 'anode#': ['anode1', 'anode2', ....]
var subAnode = [];

var i;
for (i = 0; i < header.length; i++) {
  var headerValue = header[i];
  if (headerValue.startsWith('anode')) {
    subAnode.push(headerValue);
  }
}
console.log('Subarray of only anode headers ', subAnode);

// Create a sub-array of header with '2theta' and 'anode#': ['2theta', 'anode1', 'anode2', ....]
var subAnode2 = [];

var i;
for (i = 0; i < header.length; i++) {
  var headerValue = header[i];
  if (headerValue.startsWith('anode') || headerValue.startsWith('2theta')) {
    subAnode2.push(headerValue);
  }
}
console.log('subarray with 2theta and anode ***********', subAnode2);

// How many sub-arrays in rows?
rl = rows.length;
console.log('subarrays in rows= ', rl);

// Create an array of rows whose index is the same as "2theta".

var n = header.indexOf('2theta');
console.log('>>>>>index of 2theta =', n);

var out = [];
rows.forEach(function(row, rowIdx) {
  row.forEach(function(element, elementIdx) {
    if (elementIdx == n) {
      //out.push(element);
      out.push({ index: elementIdx, value: element });
    }
  });
});

console.log('Solution:', out);

console.log('forEach Ids of rows = ', rows[0][0]);

var valueAtIndex1 = rows[1];
console.log('values at index 1     ', valueAtIndex1);

// Create an array of arrays whose indices are "anode#".

// [
//   [3, 4, 5, 6, 6,....], //44 times (1 per anode)
//   (...............)
//   [3, 4, 5, 5, 55......],
// ]; // 10 rows

out = header.map((value, index) => {
  if (value.startsWith('anode')) {
    return index;
  }
});

var indicesToPush = [];
header.forEach((value, index) => {
  if (value.startsWith('anode')) {
    indicesToPush.push(index);
  }
});

// out_rows = []
// foreach over all rows
// // out_row = [] // scope row (valid only during the inner cycle)
// // Foreach element in a row
// // // if element_index in indicesToPush: out_row.push(element)
// // out_rows.push(out_row)

console.log('************** solution:', out);

out_rows = [];
rows.forEach(innerA => {
  out_rowsNested = [];
  innerA.forEach((element, index) => {
    if (header[index].startsWith('anode')) {
      out_rowsNested.push(element);
    }
  });
  out_rows.push(out_rowsNested);
});

console.log('Solution3       :', out_rows);

// Do de same but for '2theta' and 'anode#'

// out2 = header.map((value, index) => {
//   if (value.startsWith('anode') || value.startsWith('2theta')) {
//     return index;
//   }
// });

// var indicesToPush = [];
// header.forEach((value, index) => {
//   if (value.startsWith('anode') || value.startsWith('2theta')) {
//     indicesToPush.push(index);
//   }
// });

// console.log('************** solution2:', out2);

console.log('****************** End **********************');

// x = [[1, 2, 3], [4, 5, 6], [7, 8, 9]];

// out = [];
// x.forEach(innerArray => {
//   var outNested = [];
//   console.log(innerArray, '->', out);
//   innerArray.forEach(element => {
//     console.log(element);
//     outNested.push(element);
//   });
//   out.push(outNested);
// });
// console.log('Final:', out);

// z = rows;
// out4 = [];
// z.forEach(innerArray2 => {
//   var outNested2 = [];
//   console.log(innerArray2, '->', out4);
//   innerArray2.forEach(element => {
//     console.log(element);
//     outNested2.push(element);
//   });
//   out4.push(outNested2);
// });
// console.log('Final2:', out4);

// var myArray = [],
//   X = 44;
// while (myArray.length < X) {
//   myArray.push([]);
// }
// console.log(myArray);

// function size(rows) {
//   var row_count = rows.length;
//   var row_sizes = [];
//   for (var i = 0; i < row_count; i++) {
//     row_sizes.push(rows[i].length);
//   }
//   return [row_count, Math.min.apply(null, row_sizes)];
// }

// r = size([rows]);

// console.log('size of rows', r);

// h = size([header]);

// console.log('size of header', h);

// //fill array

// var arr = [];
// var r = 10;
// var c = 44;

// fillArray(arr, r, c);

// function fillArray(arr, r, c) {
//   for (var i = 0; i < r; i++) {
//     arr.push([0]);
//     for (var j = 0; j < c; j++) {
//       arr[i][j] = 0;
//     }
//   }
// }

// console.log(arr);
// var grades = [[89, 77, 78], [76, 82, 81], [91, 94, 89]];
// var header = ['a', 'anode1', 'anode2'];

// var out = {};
// header.forEach(el => {
//   if (el.startsWith('anode')) {
//     out[el] = [];
//   }
// });
// console.log('Out init:', JSON.stringify(out));

// grades.forEach((arr, i) => {
//   //console.log(i, arr);
//   console.log('Row number:', i, ' :: Content:', arr);
//   arr.forEach((el, j) => {
//     console.log('    header:', header[j], ':: index:', j, ':: value:', el);
//     if (header[j].startsWith('anode')) {
//       out[header[j]].push(el);
//     }
//   });
// });

// JSON.stringify(header);
// JSON.stringify(grades);

var r = rows;
var h = header;

var out = {};
header.forEach(el => {
  if (el.startsWith('anode')) {
    out[el] = [];
  }
});
console.log('Out header: ', JSON.stringify(out));

rows.forEach((arr, i) => {
  console.log('Row number:', i, ' :: Content:', arr);
  arr.forEach((el, j) => {
    console.log('    header:', header[j], ':: index:', j, ':: value:', el);
    if (header[j].startsWith('anode')) {
      out[header[j]].push(el);
    }
  });
});

JSON.stringify(out);
JSON.stringify(rows);

// Have the data format like this
// [
//   {
//     "2theta": "0.1",
//     "anode1": 12.4,
//     "anode2": 13.7,
//     "anode3": 14.2
//     (...)
//     "anode49": 14.2
//   },
//   {
//     "2theta": "0.2",
//     "anode1": 1.4,
//     "anode2": 1.7,
//     "anode3": 1.2
//     (...)
//     "anode49": 10.2
//   },
//   (..................................)
// ]

h2 = header;
r2 = rows;

out_rows2 = [];
r2.forEach(innerA => {
  out_rowsNested = [];
  innerA.forEach((element, index) => {
    if (
      header[index].startsWith('anode') ||
      header[index].startsWith('2theta')
    ) {
      out_rowsNested.push(element);
    }
  });
  out_rows2.push(out_rowsNested);
});

console.log('Solution4       :', out_rows2);
